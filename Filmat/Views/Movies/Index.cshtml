@model IEnumerable<Movie>
@inject SignInManager<ApplicationUser> signInManager;


@{
    ViewData["Title"] = "List of Movies";

      Pager pager = new Pager();

    int pageNo = 0;

    if(ViewBag.Pager != null)
    {
        pager = ViewBag.Pager;
        pageNo = pager.CurrentPage;
    }
}

@section Styles {
    <link href="@Url.Content("~/css/movies.css")" rel="stylesheet"/>
}

    <a asp-action="MoviesByCategory" asp-route-category="horror">Horror</a>
    <a asp-action="MoviesByCategory" asp-route-category="Comedy">Comedy</a>
    <a asp-action="MoviesByCategory" asp-route-category="Drama">Drama</a>

@foreach (var item in Model)
    {
        
<div class="card">
    
  <a asp-action="PlayMovie" asp-route-id="@item.Id">
    <div class="img1"><img src="@item.ImageURL" alt="@item.Name" ></div>
    <div class="img2"><img src="@item.ImageURL"></div>
    <div class="title">@item.Name</div>
    <div class="text">@item.Description</div>
    <a href="#"><div class="catagory">@item.MovieCategory <i class="fas fa-film"></i></div></a>
    <a href="#"><div class="views">@item.Duration min <i class="far fa-eye"></i> </div></a>
  </a>
</div>
    @if (signInManager.IsSignedIn(User) && User.IsInRole("Admin"))
    {
        <div style:"width:auto">
            <a class="edit" title="Edit" data-toggle="tooltip" asp-action="Edit" asp-route-id="@item.Id"><i class="material-icons">&#xE254;</i></a>
            <a title="Details" data-toggle="tooltip" asp-action="Details" asp-route-id="@item.Id"><i class="material-icons">&#xE253;</i></a>
            <a 
            class="delete" 
            title="Delete" 
            data-toggle="tooltip" 
            asp-action="Delete" 
            asp-route-id="@item.Id"
        >
                <i class="material-icons">&#xE872;</i>
            </a>
        </div>
    }

    <div>
        <h1>Views:</h1>
    </div>

}
         @if(signInManager.IsSignedIn(User) && User.IsInRole("Admin")){
        <div style="position:fixed; right:25px; bottom:25px;" class="text-white">
            <a asp-controller="Movies" asp-action="Create" class="btn btn-success"><i class="bg-info bi-plus-circle">Add New</i></a>
        </div>
         }

</div>
<div class="container">
    @if (pager.TotalPages > 0)
    {
        <ul class="pagination justify-content-end">

            @if (pager.CurrentPage > 1)
            {
                <li class="page-item">
                    <a class="page-link" asp-controller="Movies" asp-action="Index" asp-route-pg="1">First</a>
                </li>
                <li class="page-item">
                    <a class="page-link" asp-controller="Movies" asp-action="Index" asp-route-pg="@(pager.CurrentPage - 1)">Previous</a>
                </li>
            }


            @for (var pge = pager.StartPage; pge <= pager.EndPage; pge++)
            {
                <li class="page-item @(pge == pager.CurrentPage ? "active" : "")">
                    <a class="page-link" asp-controller="Movies" asp-action="Index" asp-route-pg="@pge">@pge</a>
                </li>

            }
            @if (pager.CurrentPage < pager.TotalPages)
            {
                <li class="page-item">
                    <a class="page-link" asp-controller="Movies" asp-action="Index" asp-route-pg="@(pager.CurrentPage + 1)">Next</a>
                </li>
                <li>
                    <a class="page-link" asp-controller="Movies" asp-action="Index" asp-route-pg="@(pager.TotalPages)">Last</a>
                </li>
            }


        </ul>
    }
</div>





